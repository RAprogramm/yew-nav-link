#!/usr/bin/env bash
set -euo pipefail

# Ensure nightly rustfmt is available
if ! rustup toolchain list | grep -q "^nightly"; then
  rustup toolchain install nightly >/dev/null
fi
rustup component add rustfmt --toolchain nightly >/dev/null

echo "ğŸ§¹ Running cargo fmt check..."
cargo +nightly fmt --all -- --check

echo "ğŸ§ Running cargo clippy..."
cargo clippy --workspace --all-targets --all-features -- -D warnings

# echo "ğŸ“¦ Running sqlx prepare..."
# cargo sqlx prepare --check --workspace

echo "âœ… All checks passed!"
